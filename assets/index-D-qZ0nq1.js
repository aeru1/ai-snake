(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const d of document.querySelectorAll('link[rel="modulepreload"]'))a(d);new MutationObserver(d=>{for(const e of d)if(e.type==="childList")for(const i of e.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&a(i)}).observe(document,{childList:!0,subtree:!0});function r(d){const e={};return d.integrity&&(e.integrity=d.integrity),d.referrerPolicy&&(e.referrerPolicy=d.referrerPolicy),d.crossOrigin==="use-credentials"?e.credentials="include":d.crossOrigin==="anonymous"?e.credentials="omit":e.credentials="same-origin",e}function a(d){if(d.ep)return;d.ep=!0;const e=r(d);fetch(d.href,e)}})();const l=document.getElementById("GameCanvas"),n=l.getContext("2d"),A=16,I=A,W=300;let O=null,P=!1,K=!1,T="";const L=15,m=[],w={body:[{x:8,y:8},{x:7,y:8},{x:6,y:8},{x:5,y:8}],direction:{dx:1,dy:0},color:"#ee6c4d",isAI:!1},H={body:[{x:4,y:4},{x:3,y:4},{x:2,y:4},{x:1,y:4}],direction:{dx:1,dy:0},color:"#2a9d8f",isAI:!0},G=[w,H];let g=null,p=null;function v(t,o=null){for(;;){const r=Math.floor(Math.random()*A),a=Math.floor(Math.random()*I),d=G.some(f=>f.body.some(s=>s.x===r&&s.y===a)),e=t==="red"&&p&&p.x===r&&p.y===a||t==="green"&&g&&g.x===r&&g.y===a,i=o&&o.x===r&&o.y===a;if(!d&&!e&&!i){t==="red"?g={x:r,y:a}:p={x:r,y:a};break}}}function E(){const t=Math.max(100,Math.min(window.innerWidth,window.innerHeight)-100);l.width=t,l.height=t,l.style.width=t+"px",l.style.height=t+"px"}function R(){if(!n)return;n.clearRect(0,0,l.width,l.height);const t=Math.max(24,Math.floor(l.height*.08)),r=(l.height-t*2)/I,a=r*A,d=r*I,e=Math.round((l.width-a)/2),i=t,f="rgba(0,0,0,0.25)";n.fillStyle=f,n.fillRect(0,0,l.width,t);const s=e,y=Math.max(0,l.width-(e+a));s>0&&n.fillRect(0,i,s,d),y>0&&n.fillRect(e+a,i,y,d),n.fillStyle=f,n.fillRect(0,i+d,l.width,t);const h=Math.max(12,Math.floor(t*.6));n.font=`${h}px Arial`,n.textBaseline="middle";const u=Math.round(t/2);n.textAlign="left",n.fillStyle=w.color,n.fillText(`Player: ${w.body.length}`,10,u),n.textAlign="right",n.fillStyle=H.color,n.fillText(`AI: ${H.body.length}`,l.width-10,u),n.strokeStyle="rgba(255,255,255,0.08)",n.lineWidth=Math.max(1,Math.floor(l.width*.002)),n.strokeRect(e-.5,i-.5,a+1,d+1);for(let c=0;c<I;c++)for(let x=0;x<A;x++){n.fillStyle=(x+c)%2===0?"#3d5a80":"#98c1d9";const M=e+x*r,D=i+c*r;n.fillRect(Math.round(M),Math.round(D),Math.ceil(r),Math.ceil(r))}if(g){const c=e+g.x*r+r/2,x=i+g.y*r+r/2,M=r*.35;n.fillStyle="#e63946",n.beginPath(),n.arc(c,x,M,0,Math.PI*2),n.fill()}if(p){const c=e+p.x*r+r/2,x=i+p.y*r+r/2,M=r*.35;n.fillStyle="#00c853",n.beginPath(),n.arc(c,x,M,0,Math.PI*2),n.fill()}for(const c of G)B(c,r,e,i);if(P){n.fillStyle="rgba(0, 0, 0, 0.6)";const c=120;n.fillRect(0,l.height/2-c/2,l.width,c),n.fillStyle="#ffffff",n.textAlign="center",n.textBaseline="middle",n.font=`${Math.floor(l.width/12)}px Arial`,n.fillText(T,l.width/2,l.height/2-10),n.font=`${Math.floor(l.width/30)}px Arial`,n.fillText("Press Enter to restart",l.width/2,l.height/2+30)}}function B(t,o,r=0,a=0){if(!n)return;n.fillStyle=t.color;for(let x=0;x<t.body.length;x++){const M=t.body[x],D=r+M.x*o,N=a+M.y*o;n.fillRect(Math.round(D),Math.round(N),Math.ceil(o),Math.ceil(o))}const d=t.body[0],e=r+d.x*o,i=a+d.y*o,f=Math.max(1,Math.floor(o*.08));n.fillStyle="#000";let s,y,h,u;const c=t.direction||{dx:1,dy:0};c.dx===1?(s=e+o*.7,y=i+o*.3,h=e+o*.7,u=i+o*.7):c.dx===-1?(s=e+o*.3,y=i+o*.3,h=e+o*.3,u=i+o*.7):c.dy===1?(s=e+o*.3,y=i+o*.7,h=e+o*.7,u=i+o*.7):(s=e+o*.3,y=i+o*.3,h=e+o*.7,u=i+o*.3),n.beginPath(),n.arc(Math.round(s),Math.round(y),f,0,Math.PI*2),n.arc(Math.round(h),Math.round(u),f,0,Math.PI*2),n.fill()}function b(t){P=!0,T=t,O&&(clearInterval(O),O=null),R()}function C(){if(P)return;if(m.length>0){const e=m.shift(),i=w.direction;e.dx===-i.dx&&e.dy===-i.dy||(w.direction=e)}const t=G.map(e=>{const i=e.body[0],f=e.direction,s={x:(i.x+f.dx+A)%A,y:(i.y+f.dy+I)%I},y=g&&s.x===g.x&&s.y===g.y,h=p&&s.x===p.x&&s.y===p.y;return{snake:e,head:i,newHead:s,willGrow:y,ateRed:y,ateGreen:h,died:!1}});for(const e of t)for(const i of G)for(let f=0;f<i.body.length;f++){const s=i.body[f],y=f===i.body.length-1,h=t.find(u=>u.snake===i);y&&h&&!h.willGrow||s.x===e.newHead.x&&s.y===e.newHead.y&&(e.died=!0)}t[0].newHead.x===t[1].newHead.x&&t[0].newHead.y===t[1].newHead.y&&(t[0].died=t[1].died=!0),t[0].newHead.x===t[1].head.x&&t[0].newHead.y===t[1].head.y&&t[1].newHead.x===t[0].head.x&&t[1].newHead.y===t[0].head.y&&(t[0].died=t[1].died=!0);const o=t.find(e=>e.snake===w).died,r=t.find(e=>e.snake===H).died;if(o&&r){b("Draw - No KObra");return}else if(o){b("AI is the KObra");return}else if(r){b("Player is the KObra");return}for(const e of t)if(e.snake.body.unshift(e.newHead),e.willGrow||e.snake.body.pop(),e.ateRed&&v("red",e.newHead),e.ateGreen){const i=e.snake.isAI?w:H;i.body.length>1&&i.body.pop(),v("green",e.newHead)}const a=w.body.length,d=H.body.length;if(a<=1&&d<=1){b("Draw - No KObra");return}else if(a<=1){b("AI is the KObra");return}else if(d<=1){b("Player is the KObra");return}if(a>=L||d>=L){a>=L&&d>=L?b("Draw - No KObra"):a>=L?b("Player is the KObra"):b("AI is the KObra");return}R()}function $(){O||(O=setInterval(C,W))}window.addEventListener("keydown",t=>{const o=t.key.toLowerCase();if(P&&o==="enter"){k();return}!K&&!P&&(K=!0,$());let r=null;if(o==="arrowup"||o==="w"?r={dx:0,dy:-1}:o==="arrowdown"||o==="s"?r={dx:0,dy:1}:o==="arrowleft"||o==="a"?r={dx:-1,dy:0}:(o==="arrowright"||o==="d")&&(r={dx:1,dy:0}),r){const a=m.length>0?m[m.length-1]:w.direction,d=r.dx===-a.dx&&r.dy===r.dy,e=m.some(i=>i.dx===r.dx&&i.dy===r.dy);!d&&!e&&m.push(r)}});function k(){w.body=[{x:8,y:8},{x:7,y:8},{x:6,y:8},{x:5,y:8}],w.direction={dx:1,dy:0},H.body=[{x:4,y:4},{x:3,y:4},{x:2,y:4},{x:1,y:4}],H.direction={dx:1,dy:0},m.length=0,P=!1,T="",O&&(clearInterval(O),O=null),K=!1,v("red"),v("green"),R()}E();v("red");v("green");R();window.addEventListener("resize",()=>{E(),R()});
